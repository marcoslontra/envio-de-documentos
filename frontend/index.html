<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Envio de Documentos</title>
    <script src="https://static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Envio de Documentos</h1>
        <form id="uploadForm">
            <!-- Informações Pessoais -->
            <fieldset>
                <legend>Informações Pessoais</legend>

                <label for="nomeCompleto">Nome completo:</label>
                <input type="text" id="nomeCompleto" name="nomeCompleto" required>

                <label for="telefone">Telefone:</label>
                <input type="tel" id="telefone" name="telefone" required>

                <label for="dataNascimento">Data de Nascimento:</label>
                <input type="date" id="dataNascimento" name="dataNascimento" required>

                <label for="possuiFilhos">Possui filhos:</label>
                <select id="possuiFilhos" name="possuiFilhos" required>
                    <option value="Sim">Sim</option>
                    <option value="Não">Não</option>
                </select>

                <label for="rendaCasal">Renda Bruta (Casal):</label>
                <input type="number" id="rendaCasal" name="rendaCasal" required>

                <label for="possuiImovel">Possui imóvel:</label>
                <select id="possuiImovel" name="possuiImovel" required>
                    <option value="Sim">Sim</option>
                    <option value="Não">Não</option>
                </select>

                <label for="tresAnosTrabalho">Possui 3 anos de trabalho com carteira assinada?</label>
                <select id="tresAnosTrabalho" name="tresAnosTrabalho" required>
                    <option value="Sim">Sim</option>
                    <option value="Não">Não</option>
                </select>
            </fieldset>

            <!-- Botão de envio -->
            <button type="button" id="submitButton">Enviar</button>
        </form>
        <div id="result"></div>
    </div>

    <script>
        // Inicializar o cliente Filestack
        const client = filestack.init('ApgANrOfTOWJBXY2mERX1z');

        document.getElementById('submitButton').addEventListener('click', async () => {
            try {
                // Captura os dados preenchidos
                const formData = new FormData(document.getElementById('uploadForm'));
                const infoPessoais = {
                    NomeCompleto: formData.get('nomeCompleto'),
                    Telefone: formData.get('telefone'),
                    DataNascimento: formData.get('dataNascimento'),
                    PossuiFilhos: formData.get('possuiFilhos'),
                    RendaCasal: formData.get('rendaCasal'),
                    PossuiImovel: formData.get('possuiImovel'),
                    TresAnosTrabalho: formData.get('tresAnosTrabalho'),
                };

                // Converte os dados em texto
                const infoTxt = Object.entries(infoPessoais)
                    .map(([key, value]) => `${key}: ${value}`)
                    .join('\n');

                // Cria um Blob (arquivo virtual) com o texto
                const blob = new Blob([infoTxt], { type: 'text/plain' });

                // Faz o upload do arquivo TXT para o Filestack
                const response = await client.upload(blob, {
                    filename: 'informacoes_pessoais.txt',
                    mimetype: 'text/plain',
                });

                console.log('Informações Pessoais enviadas com sucesso:', response);
                document.getElementById('result').innerHTML =
                    `<p style="color: green;">Dados enviados com sucesso! URL: <a href="${response.url}" target="_blank">${response.url}</a></p>`;
            } catch (error) {
                console.error('Erro ao enviar arquivo para o Filestack:', error);
                document.getElementById('result').innerHTML =
                    `<p style="color: red;">Erro ao enviar dados: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>
